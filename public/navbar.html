<!-- public/navbar.html -->
<nav id="app-navbar" class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
<div class="container-fluid">
<!-- LEFT: Logo + Lab name -->
<a class="navbar-brand d-flex align-items-center gap-2" href="/dashboard" id="navbarBrand">
<img id="navbarLogo" alt="Lab Logo" style="height:28px;width:auto;display:none;" />
<i id="navbarFallbackIcon" class="fas fa-flask"></i>
<span id="labNameText">Laboratory Information System</span>
</a>
<!-- Toggler (Bootstrap 5) -->
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<!-- Links + RIGHT user menu -->
<div class="collapse navbar-collapse" id="navbarNav">
<!-- Left side links -->
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item" data-page="dashboard">
<a class="nav-link" href="/dashboard">
<i class="fas fa-chart-pie me-1"></i> Dashboard
</a>
</li>
<!-- Management Dropdown (Organizations, Medical Offices, Doctors) -->
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href="#" id="managementDropdown" role="button"
data-bs-toggle="dropdown" aria-expanded="false">
<i class="fas fa-building me-1"></i> Management
</a>
<ul class="dropdown-menu" aria-labelledby="managementDropdown">
<li>
<a class="dropdown-item" href="/organizations">
<i class="fas fa-sitemap me-2"></i> Organizations
</a>
</li>
<li>
<a class="dropdown-item" href="/medical-offices">
<i class="fas fa-hospital me-2"></i> Medical Offices
</a>
</li>
<li>
<a class="dropdown-item" href="/doctors">
<i class="fas fa-user-md me-2"></i> Doctors
</a>
</li>
<li><hr class="dropdown-divider"></li>
<li>
<a class="dropdown-item" href="/patients">
<i class="fas fa-users me-2"></i> Patients
</a>
</li>
</ul>
</li>
<!-- Laboratory Dropdown (Tests, Orders, Results) - ENHANCED -->
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href="#" id="laboratoryDropdown" role="button"
data-bs-toggle="dropdown" aria-expanded="false">
<i class="fas fa-vial me-1"></i> Laboratory
</a>
<ul class="dropdown-menu" aria-labelledby="laboratoryDropdown">
<!-- Test Catalog Section -->
<li><h6 class="dropdown-header">Test Management</h6></li>
<li>
<a class="dropdown-item" href="/tests">
<i class="fas fa-list me-2"></i> All Tests Catalog
</a>
</li>
<li>
<a class="dropdown-item" href="/pcr-tests">
<i class="fas fa-dna me-2 text-primary"></i> PCR Tests
</a>
</li>
<li>
<a class="dropdown-item pcr-config-item" href="/pcr-config" style="display:none;">
<i class="fas fa-cog me-2 text-warning"></i> PCR Configuration
<small class="text-muted ms-1">(Admin)</small>
</a>
</li>
<li>
<a class="dropdown-item" href="/blood-tests">
<i class="fas fa-tint me-2 text-danger"></i> Blood Tests
<small class="text-muted ms-1">(Coming Soon)</small>
</a>
</li>
<li><hr class="dropdown-divider"></li>
<!-- Orders Section -->
<li><h6 class="dropdown-header">Orders & Results</h6></li>
<li>
<a class="dropdown-item" href="/orders">
<i class="fas fa-clipboard-list me-2"></i> All Orders
</a>
</li>
<li>
<a class="dropdown-item" href="/orders/new">
<i class="fas fa-plus-circle me-2 text-success"></i> New Order
</a>
</li>
<li><hr class="dropdown-divider"></li>
<!-- Results Section -->
<li>
<a class="dropdown-item" href="/results">
<i class="fas fa-chart-line me-2"></i> All Results
</a>
</li>
<li>
<a class="dropdown-item" href="/pcr-results">
<i class="fas fa-dna me-2 text-primary"></i> PCR Results
</a>
</li>
<li>
<a class="dropdown-item" href="/blood-results">
<i class="fas fa-tint me-2 text-danger"></i> Blood Results
</a>
</li>
<li>
<a class="dropdown-item" href="/pending-results">
<i class="fas fa-clock me-2 text-warning"></i> Pending Review
</a>
</li>
</ul>
</li>
<li class="nav-item" data-page="reports">
<a class="nav-link" href="/reports">
<i class="fas fa-file-medical me-1"></i> Reports
</a>
</li>
<!-- Settings/Admin dropdown - revealed to admins by JS -->
<li class="nav-item dropdown" id="settingsNavItem" style="display:none;">
<a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button"
data-bs-toggle="dropdown" aria-expanded="false">
<i class="fas fa-cog me-1"></i> Admin
</a>
<ul class="dropdown-menu" aria-labelledby="adminDropdown">
<li>
<a class="dropdown-item" href="/settings">
<i class="fas fa-flask me-2"></i> Lab Settings
</a>
</li>
<li>
<a class="dropdown-item" href="/users">
<i class="fas fa-users-cog me-2"></i> User Management
</a>
</li>
<li><hr class="dropdown-divider"></li>
<li><h6 class="dropdown-header">Test Configuration</h6></li>
<li>
<a class="dropdown-item" href="/pcr-config">
<i class="fas fa-dna me-2"></i> PCR Test Config
</a>
</li>
<li>
<a class="dropdown-item" href="/blood-config">
<i class="fas fa-tint me-2"></i> Blood Test Config
<small class="text-muted ms-1">(Soon)</small>
</a>
</li>
<li>
<a class="dropdown-item" href="/test-prices">
<i class="fas fa-dollar-sign me-2"></i> Price Management
</a>
</li>
</ul>
</li>
</ul>
<!-- RIGHT: user dropdown (KEEPING YOUR EXACT CODE) -->
<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
<li class="nav-item dropdown">
<a id="userMenuToggle" class="nav-link dropdown-toggle d-flex align-items-center gap-2" href="#"
role="button" data-bs-toggle="dropdown" aria-expanded="false">
<i class="fas fa-user-circle"></i>
<span id="userName">User</span>
</a>
<ul class="dropdown-menu dropdown-menu-end">
<li><a class="dropdown-item" href="/profile"><i class="fas fa-id-badge me-2"></i>Profile</a></li>
<li><a class="dropdown-item" href="/settings"><i class="fas fa-cog me-2"></i>Settings</a></li>
<li><hr class="dropdown-divider"></li>
<li><button class="dropdown-item" id="logoutBtn" type="button"><i class="fas fa-sign-out-alt me-2"></i>Logout</button></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<!-- Spacer so content isn't hidden under fixed-top navbar -->
<div style="height:64px"></div>

<script>
// Add this to your existing navbar JavaScript
document.addEventListener('DOMContentLoaded', function() {
    // Get user from localStorage
    const user = JSON.parse(localStorage.getItem('user') || '{}');
    
    // Show PCR Configuration for admin users in Laboratory dropdown
    if (user.role === 'admin') {
        const pcrConfigItems = document.querySelectorAll('.pcr-config-item');
        pcrConfigItems.forEach(item => {
            item.style.display = 'block';
        });
    }
    
    // Add active class to current page
    const currentPath = window.location.pathname;
    document.querySelectorAll('.nav-link, .dropdown-item').forEach(link => {
        if (link.getAttribute('href') === currentPath) {
            link.classList.add('active');
            // If it's a dropdown item, also highlight the parent
            const dropdownParent = link.closest('.nav-item.dropdown');
            if (dropdownParent) {
                dropdownParent.querySelector('.nav-link').classList.add('active');
            }
        }
    });
});
</script>